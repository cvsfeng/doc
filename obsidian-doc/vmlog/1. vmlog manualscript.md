# 官方文档

# 我们缺少哪些
## 管理控制台功能
1. 缺少有关vmlog分区、生命周期的管理工具；
2. ssd hhd链接、移动；
3. 可视化备份工具、进展、管理；
4. 集群配置可视化；
5. 删除敏感型日志（[基于GDPR](https://en.wikipedia.org/wiki/General_Data_Protection_Regulation)合规性要求）通过接口/delete/run_task 启动一个异步任务，删除给定条件下匹配的日志；
## 有关force flush
如果配置有这个配置，那么便有 n秒不可查，所以这里需要告警配合，否则容易查不出来；
# 高可用
# # vlagent
日志收集器：日志收集器支持将收到的相同数据发送到多个目标位置（即复制）。建议使用vlagent。其它常用的日志收集器也提供此功能
## VictoriaLogs单节点实例
将收集到的日志副本发送到**不同可用区**中的**多个VictoriaLogs**实例，以实现可用性；
## vmauth
1. 通过查询日志`vmaut` 它在可用的VictoriaLogs实例之间平衡传入的查询，如果某些实例暂不可用，则自动将请求路由到健康的后端；
2. 通过所传递的租户信息，可以对租户级别进行管理访问控制。经由vmauth的访问过程中，在header中传递AccountID、ProjectID进行控制。如：
```
users:
  - username: "foo"
    password: "bar"
    url_map:
      - src_paths:
        - "/select/.*"
        - "/insert/.*"
        headers:
          - "AccountID: 1"
          - "ProjectID: 0"
        url_prefix:
          - "http://localhost:9428/"

  - username: "baz"
    password: "bar"
    url_map:
      - src_paths: ["/select/.*"]
        headers:
          - "AccountID: 2"
          - "ProjectID: 0"
        url_prefix:
          - "http://localhost:9428/"
```
# profiling
VictoriaLogs提供了用于收集以下`go配置文件`的处理程序：
- 内存使用情况分析
```
curl http://0.0.0.0:9428/debug/pprof/heap >mem.pprof
```
- cpu性能分析：
```
curl http://0.0.0.0:9428/debug/pprof/profile > cpu.pprof
```
# 参数配置
- -fs.maxConcurrency
```
The maximum number of concurrent goroutines to work with files; smaller values may help reducing Go scheduling latency on systems with small number of CPU cores; higher values may help reducing data ingestion latency on systems with high-latency storage such as NFS or Ceph (default 16x CPU cores, default capped at 256)
```
- http.disablResponseCompression(==省cpu==)
```
Disable compression of HTTP responses to save CPU resources. By default, compression is enabled to save network bandwidth  
```
- http.maxGraceFulShutdownDuration
```
The maximum duration for a graceful shutdown of the HTTP server. A highly loaded server may require increased value for a graceful shutdown (default 7s)
```
- inmemoryDataFlushinterval
```
The interval for guaranteed saving of in-memory data to disk. The saved data survives unclean shutdowns such as OOM crash, hardware reset, SIGKILL, etc. Bigger intervals may help increase the lifetime of flash storage with limited write cycles (e.g. Raspberry PI). Smaller intervals increase disk IO load. Minimum supported value is 1s (default 5s)
```
- insert.concurrency
```
The average number of concurrent data ingestion requests, which can be sent to every -storageNode (default 2)
```
- insert.disableCompression(==省cpu增加网络==)
```
Whether to disable compression when sending the ingested data to -storageNode nodes. Disabled compression reduces CPU usage at the cost of higher network usage
```
- insert.maxFieldsPerLine
```
The maximum number of log fields per line, which can be read by /insert/* handlers; see https://docs.victoriametrics.com/victorialogs/faq/#how-many-fields-a-single-log-entry-may-contain (default 1000)  
```
- insert.maxLineSizeBytes
```
The maximum size of a single line that can be read by /insert/* handlers. Regardless of this flag, entries above the 2 MB limit are ignored, see https://docs.victoriametrics.com/victorialogs/faq/#what-length-a-log-record-is-expected-to-have Supports the following optional suffixes for size values: KB, MB, GB, TB, KiB, MiB, GiB, TiB (default 262144)
```
- internStringDisableCache（==省内存增加cpu消耗==）
```
Whether to disable caches for interned strings. This may reduce memory usage at the cost of higher CPU usage. See https://en.wikipedia.org/wiki/String_interning . See also -internStringCacheExpireDuration and -internStringMaxLen
```
- internStringMaxLen(==省内存，增加cpu消耗==)
```
The maximum length for strings to intern. A lower limit may save memory at the cost of higher CPU usage. See https://en.wikipedia.org/wiki/String_interning . See also -internStringDisableCache and -internStringCacheExpireDuration (default 500)
```
